{% extends 'registration/login_base.html' %}
{% load static %}
{% block title %}Iniciar Sesión{% endblock %}

{% block content %}
<div class="flex flex-col justify-center items-center min-h-screen p-6 bg-base-200">
    <div class="w-full max-w-md">
        <div class="text-center mb-6">
            {% if configuracion.logo %}
                <img src="{{ configuracion.logo.url }}" alt="Logo Institución" class="w-24 h-24 mx-auto mb-4 object-contain rounded-full bg-base-100 p-2 shadow">
            {% endif %}
            <h1 class="text-2xl font-bold text-base-content">{{ configuracion.nombre_institucion|default:"Gestión Docente" }}</h1>
            <h2 class="text-3xl font-bold mt-4">Bienvenido de Nuevo</h2>
            <p class="text-base-content/70 mt-1">Inicia sesión para acceder a tu cuenta.</p>
        </div>

        <div class="card bg-base-100 shadow-xl w-full">
            <div class="card-body p-8">
                <form method="post" class="space-y-4">
                    {% csrf_token %}

                    <div class="form-control">
                        <label for="{{ form.username.id_for_label }}" class="label">
                            <span class="label-text">Usuario o DNI</span>
                        </label>
                        <input type="text" id="{{ form.username.id_for_label }}" name="{{ form.username.name }}"
                               placeholder="Ingresa tu usuario o DNI"
                               class="input input-bordered w-full"
                               autocomplete="username"
                               required>
                    </div>

                    <div class="form-control">
                        <label for="id_password" class="label">
                            <span class="label-text">Contraseña</span>
                        </label>
                        <div class="relative w-full">
                            <input type="password" id="id_password" name="{{ form.password.name }}"
                                   placeholder="Ingresa tu contraseña"
                                   class="input input-bordered w-full pr-10"
                                   autocomplete="current-password"
                                   required>
                            <span id="togglePassword" class="absolute inset-y-0 right-0 flex items-center pr-3 cursor-pointer text-base-content/50 hover:text-base-content">
                                <i class="fa-solid fa-eye" id="eye-icon"></i>
                            </span>
                        </div>
                    </div>

                    {% if form.errors %}
                    <div role="alert" class="alert alert-error text-sm mt-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        <span>Credenciales incorrectas. Por favor, verifica tus datos.</span>
                    </div>
                    {% endif %}

                    <div class="form-control pt-4">
                        <button type="submit" class="btn btn-primary w-full">
                            Iniciar Sesión
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <footer class="text-center mt-8 text-sm text-base-content/60">
        &copy; {% now "Y" %} {{ configuracion.nombre_institucion|default:"Tu Institución" }}. Todos los derechos reservados.
    </footer>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const togglePassword = document.querySelector('#togglePassword');
        const passwordInput = document.querySelector('#id_password');
        const eyeIcon = document.querySelector('#eye-icon');

        if (togglePassword) {
            togglePassword.addEventListener('click', function () {
                // Cambiar el tipo de input (password/text)
                const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                passwordInput.setAttribute('type', type);

                // Cambiar el ícono del ojo
                eyeIcon.classList.toggle('fa-eye');
                eyeIcon.classList.toggle('fa-eye-slash');
            });
        }
    });
</script>
{% endblock %}
